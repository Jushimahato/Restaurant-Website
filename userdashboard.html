<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- Font Awesome CDN -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: Arial, sans-serif;
        overflow: hidden;
      }
      .container {
        display: flex;
        width: 100vw; /* Full width of the viewport */
        height: 100vh; /* Full height of the viewport */
        background-color: #000;
        color: #fff;
      }
      .list1 {
        display: flex;
        align-items: center;
        height: 50px;
        padding: 20px;
        cursor: pointer;
      }
      .left {
        width: 250px;
        border-right: 4px solid #e81f63;
        padding: 15px;
        font-size: 16px;
        display: flex;
        flex-direction: column;
        background-color: #111;
        position: fixed;
        height: 100%;
        top: 0;
        left: 0;
        transform: translateX(0);
        transition: transform 0.3s ease;
        z-index: 1000; /* Ensure sidebar is on top */
      }
      .left p {
        display: flex;
        align-items: center;
        font-size: 16px;
      }
      .left p i {
        margin-right: 10px;
        color: #e81f63;
      }
      .left hr {
        border: 0;
        border-top: 1px solid grey;
      }
      .right {
        flex-grow: 1; /* Take up remaining space */
        display: flex;
        gap: 10px;
        padding: 20px;
      }
      .inner1,
      .inner2 {
        width: 100%;
        height: 100vh;
        background-color: #292929;
        padding: 20px;
        box-sizing: border-box;
        border-radius: 8px;
      }
      .inner1 h2,
      .inner2 h2 {
        margin-bottom: 20px;
        font-size: 24px;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }
      th,
      td {
        text-align: left;
        padding: 10px;
        border-bottom: 1px solid #444;
      }
      th {
        background-color: transparent;
      }
      td img {
        width: 50px;
        height: 50px;
        object-fit: cover;
      }

      .navbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        background-color: #e81f63;
        color: #fff;
        flex-wrap: wrap;
      }
      .logo {
        font-size: 1.5em;
      }
      .navbar-menu {
        display: flex;
        gap: 10px;
        list-style: none;
        margin: 0;
        padding: 0;
        align-items: center;
      }
      .navbar-menu li {
        margin: 0;
      }
      .icons {
        display: flex;
        gap: 20px;
        align-items: center;
      }
      .btn {
        padding: 4px;
        background-color: white;
        color: #000;
        border: none;
        border-radius: 4px;
        width: 60px;
        height: 30px;
        cursor: pointer;
      }
      .btn:hover {
        background-color: #f0f0f0;
      }
      .toggle-btn {
        display: none;
        background: none;
        border: none;
        cursor: pointer;
        color: #fff;
        font-size: 1.5em;
      }
      .toggle-btn .bar {
        display: block;
        width: 25px;
        height: 2px;
        background-color: #fff;
        margin: 5px 0;
        transition: all 0.3s;
      }
      @media (max-width: 768px) {
        .left {
          transform: translateX(-100%);
        }
        .left.show {
          transform: translateX(0);
        }
        .navbar-menu {
          display: none;
          flex-direction: column;
          width: 100%;
          text-align: center;
        }
        .navbar-menu.active {
          display: flex;
        }
        .toggle-btn {
          display: block;
        }
        .icons {
          margin-top: 10px;
          flex-direction: column;
        }
      }

      .avatar {
        background-color: #fff;
        color: #e81f63;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 1.2em;
      }
      .avatar a {
        text-decoration: none;
      }
      .inner1 {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background-color: #1e1e1e;
        border-radius: 8px;
        padding: 20px;
        box-sizing: border-box;
      }

      .profile {
        text-align: center;
      }

      .profile-pic {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        margin-bottom: 15px;
        border: 3px solid #e81f63;
      }

      .profile-name {
        font-size: 22px;
        margin-bottom: 5px;
      }

      .profile-email {
        font-size: 16px;
        color: #bbb;
      }
      .profile-section {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
    </style>
  </head>
  <body>
    <nav>
      <div class="navbar">
        <div class="logo">BHOKLAGYO</div>
        <button class="toggle-btn" aria-label="Toggle Navigation">
          <span class="bar"></span>
          <span class="bar"></span>
          <span class="bar"></span>
        </button>
        <ul class="navbar-menu">
          <li>Home</li>
          <li>Menu</li>
          <li>Service</li>
          <li>About Us</li>
          <div class="icons" id="user-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              x="0px"
              y="0px"
              width="24"
              height="24"
              viewBox="0 0 50 50"
            >
              <path
                d="M 21 3 C 11.621094 3 4 10.621094 4 20 C 4 29.378906 11.621094 37 21 37 C 24.710938 37 28.140625 35.804688 30.9375 33.78125 L 44.09375 46.90625 L 46.90625 44.09375 L 33.90625 31.0625 C 36.460938 28.085938 38 24.222656 38 20 C 38 10.621094 30.378906 3 21 3 Z M 21 5 C 29.296875 5 36 11.703125 36 20 C 36 28.296875 29.296875 35 21 35 C 12.703125 35 6 28.296875 6 20 C 6 11.703125 12.703125 5 21 5 Z"
                fill="#FFFFFF"
              ></path>
            </svg>
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M7 4H4V2H1V4H2L5 14H18L21 4H7ZM4 6H6L8 12H17L19 6H4ZM8 18C8 16.8954 8.89543 16 10 16C11.1046 16 12 16.8954 12 18C12 19.1046 11.1046 20 10 20C8.89543 20 8 19.1046 8 18ZM16 18C16 16.8954 16.8954 16 18 16C19.1046 16 20 16.8954 20 18C20 19.1046 19.1046 20 18 20C16.8954 20 16 19.1046 16 18Z"
                fill="#FFFFFF"
              ></path>
            </svg>
            <button id="login-btn" class="btn">Login</button>
            <button id="signup-btn" class="btn">SignUp</button>
          </div>
        </ul>
      </div>
    </nav>
    <div class="container">
      <div class="left" id="sidebar">
        <div class="list1">
          <p><i class="fas fa-tachometer-alt"></i> Dashboard</p>
        </div>
        <hr />
        <div class="list1">
          <p><i class="fas fa-box"></i> Orders</p>
        </div>
        <hr />
        <div class="list1">
          <p><i class="fas fa-utensils"></i> Menu</p>
        </div>
        <hr />
        <div class="list1">
          <p><i class="fas fa-th-large"></i> Food Category</p>
        </div>
        <hr />
        <div class="list1">
          <p><i class="fas fa-carrot"></i> Ingredients</p>
        </div>
        <hr />
        <div class="list1">
          <p><i class="fas fa-calendar-alt"></i> Events</p>
        </div>
        <hr />
        <div class="list1">
          <p><i class="fas fa-info-circle"></i> Details</p>
        </div>
        <hr />
        <div class="list1">
          <p id="logout-btn">
            <a href="" style="text-decoration: none; color: #fff"
              ><i class="fas fa-sign-out-alt"></i> Logout</a
            >
          </p>
        </div>
      </div>

      <div class="right">
        <!-- Recent Order Section -->

        <div class="inner1">
          <div class="profile-section">
            <h2>User Profile</h2>
            <img
              src="https://via.placeholder.com/100"
              alt="Profile Picture"
              class="profile-pic"
            />
            <p>Name: <span id="profile-name">Jushi Mahato</span></p>
            <p>
              Email: <span id="profile-email">jushi.mahato143@gmail.com</span>
            </p>
          </div>
        </div>
      </div>
    </div>
    <script src="js/userdashboard.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const toggleButton = document.querySelector(".toggle-btn");
        const navbarMenu = document.querySelector(".navbar-menu");
        const signupButton = document.getElementById("signup-btn");
        const loginButton = document.getElementById("login-btn");
        const registerSection = document.querySelector(".register");
        const loginSection = document.querySelector(".login");
        const closeButtons = document.querySelectorAll(".close-btn");
        const showLoginLink = document.getElementById("show-login");
        const showRegisterLink = document.getElementById("show-register");
        const userIcon = document.getElementById("user-icon");

        toggleButton.addEventListener("click", () => {
          navbarMenu.classList.toggle("active");
        });

        signupButton.addEventListener("click", () => {
          registerSection.classList.add("active");
        });

        loginButton.addEventListener("click", () => {
          loginSection.classList.add("active");
        });

        closeButtons.forEach((button) => {
          button.addEventListener("click", () => {
            registerSection.classList.remove("active");
            loginSection.classList.remove("active");
          });
        });

        // Registration functionality

        // Login functionality

        function displayAvatar(name) {
          const firstLetter = name.charAt(0).toUpperCase();
          userIcon.innerHTML = `<div class="avatar"><a href = "userdashboard.html"> ${firstLetter}</a></div>`;
        }

        // Display avatar if logged in
        const token = localStorage.getItem("token");
        const name = localStorage.getItem("name");
        if (token && name) {
          displayAvatar(name);
        }

        logoutButton.addEventListener("click", () => {
          localStorage.removeItem("token");
          localStorage.removeItem("name");
          window.location.href = "index.html"; // Redirect to index.html after logout
        });
      });

      document.addEventListener("DOMContentLoaded", async function () {
        const token = localStorage.getItem("token");

        if (!token) {
          window.location.href = "index.html"; // Redirect to login if not logged in
          return;
        }

        try {
          
          const response = await fetch("http://localhost:5000/api/user/profile", {
            method: "GET",
            headers: {
              Authorization: `Bearer ${token}`,
              "Content-Type": "application/json",
            },
          });

          if (response.ok) {
            const user = await response.json();
            console.log("User Details on Dashboard:", user); // Log user details to the console
            document.getElementById("profile-name").textContent = user.name;
            document.getElementById("profile-email").textContent = user.email;
          } else {
            console.error("Failed to fetch user profile");
          }
        } catch (error) {
          console.error("Error fetching user details:", error);
        }
        document
          .getElementById("logout-btn")
          .addEventListener("click", function () {
            localStorage.removeItem("name ");

            localStorage.removeItem("token");
            window.location.href = "index.html";
          });
        console.log("User Details on Dashboard");
      });
      document
        .getElementById("toggle-btn")
        .addEventListener("click", function () {
          document.getElementById("sidebar").classList.toggle("show");
          document.querySelector(".right").classList.toggle("shift");
        });

      // Logout button functionality
    </script>
  </body>
</html>
